"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};define("wixUrlParser/utils/urlParserUtils",["lodash","coreUtils"],function(e,t){function a(a){if(a.isResolvedSiteData)return a;var r=a.getCurrentUrlPageId(),i=e.get(a.getMasterPageData(),["data","document_data"]),n=e(i).filter({type:"PermaLink"}).keyBy("id").value(),o=e.keyBy(a.getPagesDataItems(),"id");o.masterPage=a.getDataByQuery("masterPage");var l=t.siteDataUtils,s={primaryPageId:a.getPrimaryPageId(),urlFormat:a.getUrlFormat(),mainPageId:a.getMainPageId(),externalBaseUrl:a.getExternalBaseUrl(),unicodeExternalBaseUrl:a.getUnicodeExternalBaseUrl(),publicBaseUrl:a.getPublicBaseUrl(),currentUrl:a.currentUrl,currentUrlPageId:r,isFeedbackEndpoint:a.isFeedbackEndpoint(),isSiteHistoryEndpoint:a.isSiteHistoryEndpoint(),isViewerMode:a.isViewerMode(),isWixSite:a.isWixSite(),languageCode:a.getLanguageCode(),isTemplate:a.isTemplate(),isUsingSlashUrlFormat:a.isUsingUrlFormat(t.siteConstants.URL_FORMATS.SLASH),isPremiumDomain:a.isPremiumDomain(),allPageIds:a.getAllPageIds(),routersConfigMap:e.get(a,"routers.configMap"),cookie:l.getRequestModel(a,"cookie"),serviceTopology:{basePublicUrl:a.getServiceTopologyProperty("basePublicUrl"),baseDomain:a.getServiceTopologyProperty("baseDomain"),staticDocsUrl:a.getServiceTopologyProperty("staticDocsUrl")},pagesDataItemsMap:o,permalinksMap:n,mapFromPageUriSeoToPageId:l.getMapFromPageUriSeoToPageId(a),pageResponseForUrl:a.pageResponseForUrl,rootNavigationInfo:a.getRootNavigationInfo()};return s.isResolvedSiteData=!0,s}return{getResolvedSiteData:a}}),define("wixUrlParser/parsers/slashUrlParser",["lodash","coreUtils","experiment","wixUrlParser/utils/urlParserUtils"],function(e,t,a,r){function i(a){var r=t.urlUtils.parseUrl(a.externalBaseUrl).host;return e.endsWith(r,"."+t.siteConstants.FREE_DOMAIN.WIXSITE)||e.endsWith(r,"."+a.serviceTopology.baseDomain)}function n(e){return e.isPremiumDomain&&!i(e)}function o(a){var r=e.isObject(a.currentUrl)?a.currentUrl.full:t.urlUtils.parseUrl(a.currentUrl).full;return a.isTemplate&&e.startsWith(r,a.serviceTopology.basePublicUrl)}function l(e){return"object"===("undefined"==typeof window?"undefined":_typeof(window))&&window.karmaIntegration?B.BEAKER:e.isFeedbackEndpoint?B.REVIEW:e.isSiteHistoryEndpoint?B.SITE_HISTORY:e.isViewerMode?n(e)?B.PREMIUM:e.isWixSite||o(e)?B.WIX_INTERNAL:B.FREE_SITE:B.PREVIEW}function s(t){return e.map(t,encodeURIComponent)}function u(t){return e.map(t,decodeURIComponent)}function p(t,a){var r=e.find(t.pagesDataItemsMap,{pageUriSEO:a});return r&&r.id}function g(r,i){var n=t.siteDataUtils,o=n.getMapFromPageUriSeoToPageId(r),l=e.get(o,i);return a.isOpen("sv_dpages")?l||p(r,i)||t.errorPages.IDS.NOT_FOUND:l||p(r,i)||r.mainPageId}function d(a,r){var i=t.urlUtils.parseUrl(a.externalBaseUrl),n=i.path.replace(/\/$/,"").split("/").length;return r?e.drop(r.split("/"),n):[]}function c(e){return"_p"===e}function U(e,t){return!!t&&!!e.permalinksMap[t]}function f(e,t){var a=e.pagesDataItemsMap[t];return a&&"Page"===a.type&&a.tpaApplicationId>0}function I(e,t){var a=e.pagesDataItemsMap[t];return a&&"AppPage"===a.type&&"AppBuilderPage"===a.appPageType}function m(e,t){var a=e.pagesDataItemsMap[t];return a&&"AppPage"===a.type&&"AppPage"===a.appPageType&&"7326bfbb-4b10-4a8e-84c1-73f776051e10"===a.appPageId}function P(e,t){var a=e.pagesDataItemsMap[t];return a&&"AppPage"===a.type&&"AppPage"===a.appPageType&&"79f391eb-7dfc-4adf-be6e-64434c4838d9"===a.appPageId}function v(e,t){return P(e,t)||m(e,t)}function D(e){return e&&e.replace(/^https?:\/\//,"")}function y(e,a){var r=D(t.urlUtils.getBaseUrlWithPath(a,l(e)));return t.urlUtils.isSame(r,D(e.externalBaseUrl))||t.urlUtils.isSame(r,D(e.unicodeExternalBaseUrl))||t.urlUtils.isHostnameYandexWebvisor(r)||/^s3\.amazonaws\.com\/wix\-/.test(r)}function S(t,a){if(a)return e.find(t.routersConfigMap,{prefix:a})}function E(e){var a=e.query.q,r=/\:([^\:]+)\+$/.exec(a);return r&&r[1]&&t.urlUtils.parseUrl(r[1])||e}function h(r,i){var n=e.isObject(i)?i:t.urlUtils.parseUrl(i);if("webcache.googleusercontent.com"===n.hostname&&(n=E(n)),!y(r,n))return null;var o=d(r,n.path),l=e.head(o),s=e.drop(o,1),p={format:t.siteConstants.URL_FORMATS.SLASH};if(a.isOpen("sv_dpages")){var U=S(r,l);U&&(p.routerDefinition=U,p.pageAdditionalData=l+"/"+s.join("/"))}if(a.isOpen("sv_dpages")&&p.routerDefinition){p.innerRoute=s.join("/");var m=r.pageResponseForUrl;m&&m.pageId&&(p.pageId=m.pageId,p.title=m.title)}else l?c(l)?(p.pageItemId=e.head(s),p.pageId=r.currentUrlPageId||r.mainPageId):(p.pageId=g(r,l),I(r,p.pageId)?p.title=o[2]:p.title=l):(p.pageId=r.mainPageId,p.title=R(r,p.pageId));n.query.lightbox&&(p.pageItemId=n.query.lightbox,p.imageZoom=!0);var P=e.omit(n.query,F);return n.query&&!e.isEmpty(P)&&(p.queryParams=P),!(o.length>1)||a.isOpen("sv_dpages")&&p.routerDefinition||(I(r,p.pageId)?p.pageAdditionalData=e.head(s):c(l)?p.pageAdditionalData=e.drop(s,1).join("/"):f(r,p.pageId)?p.pageAdditionalData=u(s).join("/"):p.pageAdditionalData=s.join("/")),p}function R(a,r){var i=a.pagesDataItemsMap[r];return e.get(i,"pageUriSEO")||t.siteConstants.DEFAULT_PAGE_URI_SEO}function A(t){return e.omit(t.currentUrl.query,F)}function b(t){var a=e.get(t,"rootNavigationInfo.pageAdditionalData");if(a){var r=a.split("/");return e.drop(r,1).join("/")}}function x(r,i,n,o,l,u){var p=A(r),g=e.assign({},p,i.queryParams||{}),d=l||r.externalBaseUrl;d=d.replace(/\/$/,"");var c=U(r,i.pageItemId);if(a.isOpen("sv_dpages")&&(i.routerId||i.routerDefinition)){"CURRENT_INNER_ROUTE"===i.innerRoute&&(i.innerRoute=b(r)||i.innerRoute);d+="/"+(i.routerId?e.get(r.routersConfigMap,i.routerId+".prefix"):i.routerDefinition.prefix),i.innerRoute&&"/"!==i.innerRoute&&(d+="/"+i.innerRoute)}else i.pageId&&!c&&(i.pageId!==r.mainPageId||n||i.pageAdditionalData)&&(d+="/"+R(r,i.pageId));if(I(r,i.pageId)&&i.pageAdditionalData)d+="/"+i.pageAdditionalData+(i.title?"/"+i.title:"");else if(f(r,i.pageId)&&i.pageAdditionalData)d+="/"+s(i.pageAdditionalData.split("/")).join("/");else if(v(r,i.pageId)&&i.pageAdditionalData){var m=e.findKey(e.get(u,"customUrlMapping"),{id:i.pageAdditionalData});d+=m?"/"+m:"/"+i.pageAdditionalData}return i.pageItemId&&(c?i.pageAdditionalData&&(d+="/_p/"+i.pageItemId+"/"+i.pageAdditionalData):i.imageZoom&&(g.lightbox=i.pageItemId)),o||e.isEmpty(g)||"webcache.googleusercontent.com"===r.currentUrl.hostname||(d+="?"+t.urlUtils.toQueryString(g)),d}function T(e,t){return h(r.getResolvedSiteData(e),t)}function M(e,t,a,i,n,o,l){return x(r.getResolvedSiteData(e),t,a,i,n,l)}function _(e,a){var i=t.urlUtils.parseUrl(a);return y(r.getResolvedSiteData(e),i)}var F=["lightbox"],B={PREVIEW:7,SITE_HISTORY:8,WIX_INTERNAL:2,FREE_SITE:1,PREMIUM:0,REVIEW:3,BEAKER:3};return{parseUrl:T,getUrl:M,isUrlToCurrentSite:_}}),define("wixUrlParser/parsers/hashBangUrlParser",["loggingUtils","coreUtils","lodash","wixUrlParser/utils/urlParserUtils"],function(e,t,a,r){function i(a){var r;return"string"==typeof a?r=t.urlUtils.parseUrl(a):a.full?r=a:e.log.error("url to parse has to be either a string or an object"),r}function n(e,t){return a.includes(e.allPageIds,t)}function o(e,t){var a={},r=e.match(/#!(.*?)\/zoom[\/\|](.+?)\/([^\/]+)$/i);if(!r){var i=e.match(/#!(.*?)[\/\|]([^\/]+)\/?(.*$)/i);if(i){var o=i[1],l=i[2],s=i[3];return o&&(a.title=o),n(t,l)?a.pageId=l:(a.pageId=t.primaryPageId||t.mainPageId,a.pageItemId=l),s&&(a.pageAdditionalData=s),a}return{pageId:t.mainPageId}}return r[1]&&(a.title=r[1]),a.pageId=r[2],a.pageItemId=r[3],a.imageZoom=!0,a}function l(e,r,i,n){var o=e.currentUrl,l=n||e.externalBaseUrl;l=l.replace("."+t.siteConstants.FREE_DOMAIN.WIXSITE+"/","."+t.siteConstants.FREE_DOMAIN.WIX+"/");var s=o.query;return i||a.isEmpty(s)||(l+="?"+t.urlUtils.toQueryString(s)),o.url=l,r.id&&(l+="#!"+r.title+"/"+r.id),r.additionalData&&(l+="/"+r.additionalData),l}function s(e,t){if(!t)return null;var r=i("#"===t?e.currentUrl:t),n="localhost"===r.hostname;return u(e,r)&&!n?e.currentUrl.full!==r.full||a.includes(r.full,"#")?null:{pageId:e.mainPageId}:(a.isString(t)&&0===t.indexOf("#!")&&(r=a.clone(e.currentUrl),r.hash=t),o(r.hash,e))}function u(e,a){return!(t.urlUtils.isHostnameYandexWebvisor(a.hostname)||d(e,a))}function p(e,t){var a=e.pagesDataItemsMap[t];return a&&"AppPage"===a.type&&"AppPage"===a.appPageType&&"7326bfbb-4b10-4a8e-84c1-73f776051e10"===a.appPageId}function g(e){return e&&e.replace(/^https?:\/\//,"")}function d(e,a){var r=a.hostname+a.path;return t.urlUtils.isSame(r,g(e.externalBaseUrl))||t.urlUtils.isSame(r,g(e.unicodeExternalBaseUrl))}function c(e,a,r,i,n,o){var s={title:a.title||t.siteConstants.DEFAULT_PAGE_URI_SEO};if(a.pageItemId&&!a.pageAdditionalData&&a.imageZoom?(s.id="zoom",s.additionalData=a.pageId+"/"+a.pageItemId):(a.pageId!==e.mainPageId||a.pageAdditionalData||r)&&(s.id=a.pageItemId||a.pageId,s.additionalData=a.pageAdditionalData),p(e,a.pageId)&&o){var u=a.pageAdditionalData||"",g=o[u]||o[decodeURIComponent(u)]||{};s.id=a.pageId,s.title=g.title,s.additionalData=g.id}return l(e,s,i,n)}function U(e,t){return s(r.getResolvedSiteData(e),t)}function f(e,t,a,i,n,o){return c(r.getResolvedSiteData(e),t,a,i,n,o)}function I(e,a){if("#"===a)return!0;var i=t.urlUtils.parseUrl(a);return d(r.getResolvedSiteData(e),i)}return{parseUrl:U,getUrl:f,isUrlToCurrentSite:I}}),define("wixUrlParser",["lodash","coreUtils","wixUrlParser/parsers/slashUrlParser","wixUrlParser/parsers/hashBangUrlParser","wixUrlParser/utils/urlParserUtils"],function(e,t,a,r,i){function n(a,r){var i=e.isObject(r)?r:t.urlUtils.parseUrl(r);return!t.stringUtils.startsWith(i.hash,"#!")&&a.isUsingSlashUrlFormat}function o(e,t){return d[t||e.urlFormat]||d[e.urlFormat]}function l(e,t){return t===e.replace(/\/$/,"")+"/app"}function s(e,t){var o=i.getResolvedSiteData(e);return!t||l(o.externalBaseUrl,t)?null:"#"===t?s(o,o.currentUrl.full):n(o,t)?a.parseUrl(o,t):r.parseUrl(o,t)}function u(e,t,a,r,n,l){var s=i.getResolvedSiteData(e);return o(s,t.format).getUrl(s,t,a,r,n,l,e)}function p(e,t){var o=i.getResolvedSiteData(e);return n(o,t)?a.isUrlToCurrentSite(o,t):r.isUrlToCurrentSite(o,t)}function g(e,t){if(p(e,t)){var a=e.currentUrl.protocol;return t.replace(/^https?:/,a)}return t}var d={slash:a,hashBang:r};return{getUrl:u,parseUrl:s,utils:i,normalizeProtocolForSameSite:g}});
//# sourceMappingURL=wixUrlParser.min.js.map